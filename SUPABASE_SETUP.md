# Supabase Setup Instructions

To make your website dynamic, you need to set up the database structure in your Supabase project.

## Step 1: Run SQL Scripts

1.  Go to your [Supabase Dashboard](https://supabase.com/dashboard).
2.  Open your project (`mmeuwvuvglvwxtforlcp`).
3.  Go to the **SQL Editor** (icon on the left sidebar).
4.  Click **New Query**.
5.  Copy and paste the entire SQL block below into the editor.
6.  Click **Run**.

```sql
-- 1. Create the Products Table
create table public.products (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  name text not null,
  price_usd numeric not null,
  image_url text,
  featured boolean default false,
  category text,
  description text,
  details jsonb, -- Stores mileage, transmission, fuel
  gallery text[] -- Array of image URLs
);

-- 2. Create the Inquiries Table (for Contact Form)
create table public.inquiries (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  name text not null,
  email text not null,
  phone text,
  interest text,
  message text,
  vehicle_name text -- Optional: If inquiring about a specific car
);

-- 3. Enable Row Level Security (RLS)
alter table public.products enable row level security;
alter table public.inquiries enable row level security;

-- 4. Create Security Policies

-- Policy: Everyone can READ products
create policy "Public Read Products"
on public.products for select
to anon
using (true);

-- Policy: Only Admins (Authenticated Users) can MODIFY products
create policy "Admin Modify Products"
on public.products for all
to authenticated
using (true)
with check (true);

-- Policy: Everyone can CREATE inquiries (Submit form)
create policy "Public Create Inquiries"
on public.inquiries for insert
to anon
with check (true);

-- Policy: Only Admins can READ inquiries
create policy "Admin Read Inquiries"
on public.inquiries for select
to authenticated
using (true);

-- 5. Set up Storage for Images
insert into storage.buckets (id, name, public)
values ('vehicle-images', 'vehicle-images', true)
on conflict (id) do nothing;

-- Storage Policy: Everyone can VIEW images
create policy "Public View Images"
on storage.objects for select
to anon
using ( bucket_id = 'vehicle-images' );

-- Storage Policy: Only Admins can UPLOAD images
create policy "Admin Upload Images"
on storage.objects for insert
to authenticated
with check ( bucket_id = 'vehicle-images' );

-- Storage Policy: Only Admins can DELETE images
create policy "Admin Delete Images"
on storage.objects for delete
to authenticated
using ( bucket_id = 'vehicle-images' );

-- 6. Add Multilingual Support (Required for Auto-Translate)
ALTER TABLE public.products
ADD COLUMN IF NOT EXISTS name_ar text,
ADD COLUMN IF NOT EXISTS description_ar text,
ADD COLUMN IF NOT EXISTS category_ar text,
ADD COLUMN IF NOT EXISTS details_ar jsonb;
```

## Step 2: Create an Admin User

1.  Go to the **Authentication** tab in the sidebar.
2.  Click **Add User**.
3.  Enter your email and a secure password.
4.  Check "Auto Confirm User" (so you don't need email verification right now).
5.  Click **Create User**.
6.  **Repeat** this step to add your client's email as well.

Now you can log in to the admin panel using these credentials.
